This is terse but detailed list of steps to develop the model.  See ResearchPlanMSNsignalingPathway.txt for bigger picture, including
     What are the big research questions
     What are some little research questions
     Some experiments that can help test/develop the model
     See NeuroRD.bat for information on how to run models
This file is also used to keep track of which steps have been done, and what needs to be done next.

NEXT STEPS:
Get Backsai and Mironov papers.  Adjust PDEs to achieve 2.5 uM peak cAMP in soma (10 nM Da stim?)
a. even slower PKA phos of PDE10
b. add in other PDEs: 250 nM affinity means that PDE10 can saturate easily
  b1: True PDE4 with correct affinity
  b2: PDE2: 40 uM affinity for cAMP, 1 uM affinity for 2nd cAMP, 18x activity when 2 cAMP are bound (pretend that 1st cAMP is a cGMP); lower PDE10 concentration to compensate (will this enhance "soma" response? or maybe slower PKA phos of PDE10 will compensate)
c. add in Gi and receptors
   In Neves, this is D2 if A2A neuron; In D1 neuron this is m4
   because these are sm, and soma and dend have same sm, prob won't help.  this will help when spine added
   
June 3, 2015: figured out surface layers behavior
1. If the surfaceLayers sum to less than defaultMaxElementSide
	     (or the resulting element size if morphology/default is not integer)
	     then the radius will be reduced by elementsize - sum(surfaceLayer),
2. When only a single voxel is created, surfaceLayers adds to the morphology diameter
2. Running simulations with 1000 nM dopamine, instead of 10 nM.  This still might not be a high enough concentration, but should produce nice response.
3. python code is fixed - correctly calculates totals for multi-voxel morphology
4. Though DaD1RGs complex is forming, no GasGTP is being formed, and cAMP is dropping to zero, even with 1000 nM dopamine. - bug in rxn spec.  Fixed  Also, increased molecule concentrations - ~1.3 uM AC and PKA, 260 nM D1R, 2600 nM Gas
####Now, adjust AC, PDE10 for correct basal, then adjust PKA & pPDE10 activity for correct peak.
	 Possibly will need to adjust D1R and Gs if not enough (or too much) GasGTP
5. Results (Gs=10xD1R,PKA=AC)
param				ss	     peak
1.5um D1R=200,AC=1000,PDE10=400	cAMP=15-20   cAMP:20uM, PKAr=120-70,pPDE4cAMP=500-400
6.5um D1R=200,AC=1000,PDE10=400	cAMP=60	     cAMP:3.8uM, PKAr=30,pPDE4cAMP=100-80
1.5:Since ss is too low and peak too high, need more active pPDE10; pPDE10 increase is somewhat slow (cAMP is quite transient, not persistant) so I don't think PKA phos should be slower
6.5: peak is reasonable, but too transient.  If pPDE10 is stronger, peak will be lower, but no less transient.  If make PKA phos slower, then peak will be higher again, and perhaps less transient.
Vince's data showed transient responses, but on much slower time scale than my simulations.  Once reasonable values, will re-initialize (allow shorter time before stim), and run longer simulations
Result of 2x stronger pPDE10 (pPDE10 = 4x PDE10)
param				ss	     peak
1.5um D1R=200,AC=1000,PDE10=400	cAMP=15-20   cAMP:8uM, PKAr=100-20,pPDE4cAMP=300-200
6.5um D1R=200,AC=1000,PDE10=400	cAMP=45	     cAMP:1.2uM, PKAr=25,pPDE4cAMP=50-40
EVEN MORE TRANSIENT - BAD, lower peak in dend - good, similarly low basal

1.5:Since ss is too low and peak too high, need more active pPDE10; pPDE10 increase is What if have both sm and cyt spec for PDE10 (currently all is sm)?  Put half of PDE10 in sm - scales with AC, and other half as cyt?  Or keep current amount, make PKA phos rate 10x slower (not just a little slower) and move 1/4 of sm PDE10 to cyt:
change 400 to 300, add in 200 cyt? - same amount in dend, but will be more in soma - lower basal soma, perhaps higher transient in soma
Result of 10x slower PKAc + sm300 and cyt200 PDE10 (+4x pPDE10):
1.5um D1R=200,AC=1000:	cAMP=50uM   cAMP:50uM, PKAr=140-120,pPDE4cAMP=0-250
6.5um D1R=200,AC=1000:	cAMP=30	     cAMP:0.6uM, PKAr=25,pPDE4cAMP=10-12
If still too transient, go back to 2x pPDE10 (yes, it is)
If dend is still too low and high, and soma still to high and low:
need higher basal PDE10 dend and lower PDE10 stim
need lower basal PDE10 soma (achieved by cyt PDE10) and lower PDE10 stim  - 2x pPDE10
RESULT of 10x slower PKAc + sm300 and cyt200 PDE10 (+2x pPDE10):
1.5um D1R=200,AC=1000:	cAMP=10nM   cAMP:100uM, PKAr=140-120,pPDE4cAMP=0-250
6.5um D1R=200,AC=1000:	cAMP=30nM   cAMP:0.65uM, PKAr=25,pPDE4cAMP reaches 16
Soma pretty good (could tweak to match Vince or Castro? - even slower PKA phos, no decay within 1 min, perhaps no PKA phos?)
Dend stim is terrible:
lower PDE10stim in dend (within minimal decrease in PDE10stim in soma) could be achieved by PKA phos of PDE10 HOWEVER, fast fb loop makes stim too transient, whereas slow fb loop fails to control peak.  Need 1 ultra fast loop and 1 super slow loop (slow PKA phos of PDE10?).  Ultrafast can't be receptor dependent because conc same for both
Note that DaD1RGs is extremely transient, ACGasATP is extremely persistant
NEXT SIMS: FB: add additional PDE, only in dend (1.5 um structure)
a. inactive without phos, extremely fast phos - implemented
b. requires two cAMP binding (cooperativity) - represents cGMP? - alternative
RESULTS:
a. cAMP peak - 80 uM, pPDE4 increase is too slow - gradual from 100 - 200 sec, make faster
b. cAMP - 25 uM and very transient.  Try making even faster.
c. cAMP = 4 uM and super transient - gone within 1 minute
TRY NEW APPROACH

June 2, 2015 - D-R-G-cAMP-PDE-PKA subset
created the rxn subset and two morphologies - one 1.5 um diameter dendrite, one 6.5 um dia (small) soma.  Both have 1 um voxels (4 um depth) but with 0.25 submembrane (check that all memb molec are only in the surface layer).  The larger one also has 0.5 um surface layer.  This will be used to adjust quantities of molecules to achieve: ~30 nM basal cAMP and ~2.5 uM stimulated cAMP.  If one is too big and other too small, likely will need to adjust rate of PKA phos of PDE, and pPDE activity.
Having two morphologies will allow me to evaluate Vince's data -effect of morphology on peak values.

STATUS: ss doen't look correct.  Fix this part of python code. 
2.1.9 is much faster than 3.0, use this till informational output is reduced
Adjust dopamine injection part to match Castro or somebody.
THEN, run simulations with different total quantities of D1R,Gs,AC,PDE

May 28 - June 1, 2015
1. Created set of files for evaluating R-G association rates from FRET study

2.Editing neurord_params_sims.py for
a) work with stochdiff-3.0.0
b) change a stim file, to allow for stimulating Da (and buffer to turn off stim)
   stim allows a non-stim baseline period (not so important), but turn off will be critical  

This worked.  Next, actually run the simulations with different Da conc and compare the results to FRET traces.

The simulations worked, but it appears as if the GasGTP production is too slow.  The low concentration Da gives a GasGTP time course similar to Bunemann, but the high concentration is also slow, whereas in measurements the saturating concentrations of ligand produce very fast FRET change.  Steady state dose-response is fine also.
G prot associ with DaD1RGs is quite fast ~1 sec, comparable to that in Hein et al. 2005. After initial production of triple complex, the decrease is quite rapid.  The slow depletion of Gsabg may be due to high Gs concentration?
After initial time point, GsD1R drops to 5%, DaD1R goes up to 80%, DaD1RGs is only ~20% for high Da conc.  Perhaps catalytic rate is too fast compared to association rate?

Need to do transient Da pulse to evaluate dissociaton rate, e.g. 15 on & 30 off.
Also, the main studies have over-expression, so perhaps do these dissociation sims with higher G expression - how much higher???
One measure method lists off rate of ~15 sec, but another method lists 2 sec - much faster.

------> increase Gs forward and backward by 10x, gives 0.7e-3 backward (1/2s=0.5)

BETTER: association quite fast - < 1 sec for high conc, but dissociation is too fast ~5 sec instead of 10 sec.  Slow down kb to 0.4, and half the kf.
Still too fast of G association, but too slow GasGTP production!  Dissociation is too fast, though maybe due to too fast reduction in Da.  Slow down 3x Da-buf rxn and re-assess.
BETTER - decay is ~10 sec, this is quite good.  Association is still quite fast (formation of DaD1Rgs < 1 sec) whereas production of GasGTP and decrease in GasGTP is too slow!
Can see Bunemann 2001 J Biol Chem for GIRK measurement using endogenous G proteins.
15 sec with conc that reaches 75% of max - similar to my sims, but only 5 sec with conc that satures - much faster than mine.  This is a2a and Gi, possibly faster hydrolysis?  Try 3x faster.

Yes, with 3x faster hydrolysis, GaGTP developed within 8 sec for saturating conc,  BUT, the ss DaD1RGs declined during the stimulation, probably because kcat is much faster than kf and kb.  BUT, do not change it like this.  A2A is coupled to Gi, maybe Gs is slower.
Note that local D1R and Gsabg conc will be higher with submembrane layers, this will speed association rxn.

NEXT - repeat these assays in Neves, but compare the D2 / Gi part.  May need to speed up kcat for GiaGTP production (but leave Gs as is)

May 15-18, 2015
    Did the first plc assay - looks good, but not great.  
    with Gaq = 0 or 261: There is no saturation of calcium binding, much less decrease with too high a calcium value.  Consider higher affinity for calcium binding.
    with Ca = 300 nM, and Gaq from 5 to 80: linear increase (fine), but IP3 is too high for the lower Gaq values - this suggests Ca affinity is too high.
    What about lower Ca affinity in absence of Gaq, but higher affinity in presence?  Above simulations used
    PLC+Ca <-> PLCCa Kd=6000 (should have been 1000-2000 nM), PIP2 bind Kd= 58 
    PLC-Gq + Ca <-> PLC-GqCa Kd=500 (should have been 200-400 nM), PIP2 bind Kd= 21.7 
    PLC + Gq <-> PLC-Gq Kd=1200 (should have been ~50)
    PLCCa + Gq <-> PLCCa-Gq Kd=100 (PMR)

    Assessment of Sims with above Kd:  Gaq binding is way too high affinity - not distinction among different Gq amounts.  Ca affinity is not too bad.  Another problem - some simulations are crashing in the middle, which is not being helped by smaller dt.  May be some other bug.  Need to get next version of neuroRD.
    It seems that the Ca = 300 nM, and Gaq low values (e.g. 5-15) are quite dependent on the PLC-Ca activity (i.e., activity in absence of Gq).  Perhaps lower Ca affinity will help also.
    Eliminating the activity of PlcCa helped immensely for this simulation, but then the Ca param variation doesn't work :(.
    values of kcat=0.225 are too high, kcat=0.0225 are too low (but better); 
NEXT: try kcat=0.045, and add in the 2nd DAG dissociation step
      GREAT Gq response.  Good Ca response with Gq.  Gq=0 didn't run.  Double kcat again - still good, though Ca 300 Gq 5 a bit high ,and Ca10 uM Gq = 0 a bit low
      Add in slow Gq hydrolysis: No beter in terms of things that ran.
      slightly lower Ca affinity for PLC - 2.5 uM, with 500 nM for PLC-Gq
      Fine.  Not much better.  Still too low a response for Gq=0 and to high a response for 300 nM Ca with Gq=5
      Redid the simulations of Ca dependence using 22 instead of 261 nM Gq - 22 is calculated from 55 ng and 60 uL.  Much better - 22 n nM Gq has ~2x the IP3 as 0 Gq, as in the figures.  The Gq dependence with 300 nM Ca looks good.
      Went back to the 400 nM / 2000 nM Ca affinity - Ca sensitivity looks better, though perhaps the Gq assay a bit high
      Need to re-check once the program isn't crashing with many parameter combinations.
      SLowed down Gq binding from 1.0=kb to 0.7, similar to Falkenburg - minimal  change to results
      Copied these parameters into the merged file
      May need to decrease calcium affinity a bit if have problems with calcium equilibrium

April 30, 2015
Currently working on Step 2 below.  Broken down into smaller steps
Next steps:
1. plc assay: create xml for 
   par1={'species':'GaqGTP','values':[0,261],'type':'NanoMolarity'}
   par2={'species':'Ca','values':[10,30,100,300,1e3,3e3,10e3],'type':'NanoMolarity'}
   simulate analyze, compare to smrcka
   create xml for 
   par1={'species':'GaqGTP','values':[10,20,30,40,50,60,70,80],'type':'NanoMolarity'}
   par2={'species':'Ca','values':[1,300],'type':'NanoMolarity'}
   simulate, analyze (change xval to pv[0]), compare to smrcka
2. create cAMP subset for cAMP assay (merged) 
   dend only with submembrane voxels to achieve
   correct surface to volume, and also large volume
   may need to run to steady state first
3. assess steady state values related to calcium stuff
4. Darpp assay
   dend only with submembrane voxels to achieve
   correct surface to volume, and also large volume
   may need to update IC files with a reasonable ss starting place

Step 1. Merge reactions from modified version of Rodrigo's model and BoHung's model
Notes in the RXN file indicate whether the reaction came from the Gs model (Oliveira 2012) or Gq model (Kim 2013)
DONE.  1A. Merge reactions
DONE. 1B. Use the smaller, 1 spine morphology
1C. Create initial IC file - BALANCE ALL SPECIES, concentration and total PKA, etc in dend sm and spine head
DONE. 1D. Create a no stim file
DONE. 1E. Create an everything and a simpler/reduced IO file
Compare rate constants with xpp model and Oliveira model: which rates match references theirin, which ones do not match references, which rates don't have references.
Search for updated references for rates with none or non-matching refs.  
Check thermodynamic balance of some sets of reactions.

Step 2. Adjust ... to achieve correct basal cAMP and calcium
2A. IC and RXN for calmodulin, calbindin, pumps, affinity of Ca for Dagl and PLC
2B. IC and RXN for Gs production and binding
2C. possibly include Gi reactions here to help decrease basal cAMP

Step 3. Interaction between Gs and Gq/calcium pathways
3A. CaMKII inhibition of Dagl
3B. PKA enhances of Gq GAP activity?  Via RGS or D2 neuron only?

Step 4.
4A. Re-run bath applied sims, as in Lindskog.  See PP2B dephos of DARPP32
Update the non-matching refs if better response.
4B. Re-run Uchigashima

Step 5.  Simulation experiments
5A. Stim files: Glu: how to account for release refractoriness and receptor desensitization (Ca and mGluR)?
    constrain by Lovinger imaging
5B. Stim files: Da and mACh: what pattern of release occurs (Da from Lovinger)
5C. Which temporal patterns select for LTP vs LTD?
5D. Sensitivity to order of Ca and Da?  Do we need AC1 for this aspect?