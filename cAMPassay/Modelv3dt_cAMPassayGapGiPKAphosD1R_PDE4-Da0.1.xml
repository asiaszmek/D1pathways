<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<SDRun xmlns:xi="http://www.w3.org/2001/XInclude" xmlns="http://stochdiff.textensor.org">
    <!-- this file defines a single run of the calculation, using morphology and 
	 reaction data brought in from other files --> 

    <xi:include href="Rxn_cAMPassayGapGiPKAphosD1R_PDE4.xml" />
    <xi:include href="Morph6.5um.xml" />
    <xi:include href="IC_cAMPassay6.5uPKAcD1R_PDE4.xml" />
    <xi:include href="IO_cAMPassayPKAcD1R_PDE4.xml" />
    <StimulationSet>
      <InjectionStim specieID="Da" injectionSite="pointA">
        <onset>           20000        </onset>
        <duration>           10         </duration>
        <rate>               15666.0    </rate>
      </InjectionStim>
      <InjectionStim specieID="buf" injectionSite="pointA">
        <onset>           20100        </onset>
        <duration>           2000      </duration>
        <rate>               78.3    </rate>
      </InjectionStim>

      <InjectionStim specieID="Abuf" injectionSite="pointA">
        <onset>           20000        </onset>
        <duration>           20        </duration>
        <rate>               15.0      </rate>
      </InjectionStim>
      <InjectionStim specieID="ACh" injectionSite="pointA">
        <onset>           20500        </onset>
        <duration>           10000     </duration>
        <rate>               0.01      </rate>
      </InjectionStim>
    </StimulationSet>
  

    <!--2D means the morphology is interpreted like a flatworm, 3D for
	roundworms. The 2D case is good for testing as it is easy to visualize the
results (also, 3D may not work yet...)  -->
    <geometry>          2D           </geometry>
    <depth2D>           4.0          </depth2D>
    <distribution>      BINOMIAL     </distribution>
    <algorithm>         INDEPENDENT  </algorithm>
    <simulationSeed>    123       </simulationSeed>
    <outputQuantity>NUMBER</outputQuantity>


    <!-- run time for the calculation, milliseconds -->
    <runtime>          200000         </runtime>
<!-- 100001 -->
    <!-- set the seed to get the same spines each time testing -->
    <spineSeed>          123          </spineSeed>

    <discretization>
	<!-- default largest size for elements in bulk volumes (dendrites), microns -->	
       <defaultMaxElementSide>1.0</defaultMaxElementSide> 
        
	<!-- discretization for spines, microns -->
	<spineDeltaX>   0.1           </spineDeltaX>

	<!-- This specifies the surface layers, first implemented in v.2.1.7
	This adds to the morphology diameter -->
	<surfaceLayers>0.25, 0.5</surfaceLayers>

	<!-- override the default for a particular region. -->
	<!-- Matches against id or regionClass in the morphology file -->
<!--
        <MaxElementSide region="PSD">0.1</MaxElementSide>
-->
    </discretization>

    <!-- timestep used in fixed step calculations, in milliseconds -->
    <fixedStepDt>         0.005       </fixedStepDt>

    <!-- interval at which stuff should be saved to the .out file -->
    <outputInterval>      200   </outputInterval>

    <!-- the tolerace is used as epsilon in the adapative -->
    <tolerance>           0.0025       </tolerance>
    <!-- calculation types include GRID_STEPPED_STOCHASTIC and GRID_STEPPED_CONTINUOUS for 
	 reaction-diffusion systems. Single mixed pool calculations should be listed here too (TODO) -->
    <!--calculation>GRID_STEPPED_STOCHASTIC</calculation-->
    <!--use the following for adaptive: -->
    <calculation>GRID_ADAPTIVE</calculation>

</SDRun>
